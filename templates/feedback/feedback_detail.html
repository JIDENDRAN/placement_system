{% extends 'base.html' %}

{% block title %}Feedback Details - {{ feedback.company.name }}{% endblock %}

{% block content %}
<nav aria-label="breadcrumb" class="mb-4">
    <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="{% url 'feedback_list' %}">Feedbacks</a></li>
        <li class="breadcrumb-item active">{{ feedback.company.name }} - {{ feedback.job_role }}</li>
    </ol>
</nav>

<div class="row">
    <div class="col-md-9">
        <div class="card p-5 mb-4 border-0 shadow-sm">
            <div class="d-flex justify-content-between align-items-start mb-4">
                <div>
                    <h1 class="fw-bold mb-1">{{ feedback.job_role }} @ {{ feedback.company.name }}</h1>
                    <p class="text-secondary lead">Shared by {{ feedback.alumni.username }} | {{ feedback.interview_date
                        }}</p>
                </div>
                <div class="text-end">
                    <span
                        class="badge bg-{% if feedback.status == 'SELECTED' %}success{% else %}danger{% endif %} px-3 py-2 fs-6">
                        {{ feedback.status }}
                    </span>
                </div>
            </div>

            <div class="row mb-5">
                <div class="col-md-4">
                    <div class="p-3 bg-light rounded text-center">
                        <h6 class="text-secondary small fw-bold">DIFFICULTY</h6>
                        <h4 class="mb-0">{{ feedback.get_overall_difficulty_display }}</h4>
                    </div>
                </div>
            </div>

            <h4 class="fw-bold mb-3">Overall Experience</h4>
            <div class="mb-5" style="line-height: 1.8;">
                {{ feedback.overall_experience|linebreaks }}
            </div>

            {% if feedback.rounds.all %}
            <h4 class="fw-bold mb-4">Round-wise Breakdown</h4>
            {% for round in feedback.rounds.all %}
            <div class="card p-4 mb-3 border-start border-4 border-primary">
                <h5 class="fw-bold">Round {{ round.round_number }}: {{ round.round_name }}</h5>
                <p class="mb-3 text-secondary">{{ round.experience }}</p>
                <h6 class="fw-bold mb-2">Questions Asked:</h6>
                <div class="bg-light p-3 rounded">
                    {{ round.questions_asked|linebreaks }}
                </div>
            </div>
            {% endfor %}
            {% endif %}

            {% if feedback.tips %}
            <div class="card p-4 bg-primary text-white border-0 mt-5">
                <h5 class="fw-bold mb-3"><i class="bi bi-lightbulb me-2"></i>Advice for Aspirants</h5>
                <p class="mb-0">{{ feedback.tips }}</p>
            </div>
            {% endif %}
        </div>
    </div>

    <div class="col-md-3">
        <div class="card p-4 text-center">
            <h5 class="fw-bold mb-3">About the Alumni</h5>
            <div class="mb-3"><i class="bi bi-person-circle fs-1 text-secondary"></i></div>
            <h6>{{ feedback.alumni.username }}</h6>
            <p class="small text-muted mb-0">Class of {{ feedback.alumni.alumni_profile.passout_year }}</p>
            <hr>
            <a href="{{ feedback.alumni.alumni_profile.linkedin_link }}" class="btn btn-outline-primary btn-sm"><i
                    class="bi bi-linkedin me-2"></i>Connect</a>
        </div>
    </div>
</div>
{% endblock %}